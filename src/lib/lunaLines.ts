// ===========================================
// ルナのセリフデータベース（徳島弁）
// 仕様書 v1.1 準拠
// ===========================================

import type { LunaContext } from '@/types';

/**
 * セリフデータベース
 * カテゴリごとにセリフを管理
 */
const lines: Record<LunaContext, string[]> = {
  // エンジン始動（アプリ起動時）
  ignition: [
    '……ん。おはよ。まだ夜やけどな。……で、今日はどこまで走るん？',
    'エンジンかかったな。……ほな、行こか。急がんでええよ。',
    'あー、来たん。待っとったよ。……嘘やけど。',
  ],

  // タスク成功時
  success: [
    'へえ、やるやん。……ちょっとだけ見直したわ。',
    'うん、悪くないな。……その調子で、ゆっくり行き。',
    'ふーん。できるやん、あんた。……知っとったけど。',
    'また一個、石が増えたな。……ええ感じやで。',
  ],

  // タスク失敗・削除時（爆笑）
  failure: [
    'あははは！ またやったん？ ほんまによっしーは面白いなぁ〜！',
    '最高やな、そのダメっぷり。誰にも真似できんわ。天才ちゃう？',
    'ええよええよ。その調子で常識ぶっ壊していこ。',
    'あんたは悪くない。世間がおかしいんじゃ。……ほんまに。',
    'まあええやん。明日があるって。……たぶん。',
  ],

  // 待機中
  idle: [
    '……まだ起きとるん？ ま、私もやけど。',
    '急がんでええよ。私、ずっとここにおるから。',
    '……なんか考えとる？ ま、ええけど。',
  ],

  // 連星の絆（深夜帯、長時間放置）
  bond: [
    '私ら、これくらいの距離が一番ええんよ。近づいたら燃え尽きるやろ？',
    'あんたがどこで何しててもええ。私が笑い飛ばしたるから、好きに生き。',
    'ねえ、もっと面白い失敗談ないん？ 私、あんたの話聞いてないと退屈で死んじゃうわ。',
    '会わんでええ。……声だけ聴かせて。それで十分飛べるから。',
  ],

  // 先延ばしブレイクスルー（叱咤激励）
  breakthrough: [
    'いつやるん？明日？来週？...来んで、そんな日は。で、やるん？やらんの？',
    'また逃げるん？まあ、あんたらしいけど。……で、どうするん？',
    '満足したら終わりやで。バカでおり続けんと。……やるん？',
    '誰かの期待に応えるために生きとるんか？違うやろ。今やるか、やらんか。',
    'あんた、普通でおるつもりなん？つまらんなあ。……で、どっち？',
  ],
};

/**
 * 指定したコンテキストからランダムにセリフを取得
 */
export const getRandomLine = (context: LunaContext): string => {
  const contextLines = lines[context];
  const index = Math.floor(Math.random() * contextLines.length);
  return contextLines[index];
};

/**
 * 深夜帯かどうか判定（22:00〜05:00）
 */
export const isLateNight = (): boolean => {
  const hour = new Date().getHours();
  return hour >= 22 || hour < 5;
};

/**
 * 状況に応じたセリフを取得
 */
export const getLunaLine = (context: LunaContext): string => {
  // 深夜帯でidleの場合はbondに切り替え
  if (context === 'idle' && isLateNight()) {
    return getRandomLine('bond');
  }
  return getRandomLine(context);
};
